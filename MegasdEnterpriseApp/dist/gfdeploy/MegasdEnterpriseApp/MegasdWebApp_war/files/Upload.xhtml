<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core">

    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="Upload"></h:outputText>
        </ui:define>
        <ui:define name="body">
            <div class="row">
                <h:panelGroup id="messagePanel" layout="block">
                    <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
                </h:panelGroup>
            </div>
            <div class="box">
                <div class="row">
                    <div class="col-xs-12" style="text-align: center">
                        <h1>Upload your files here</h1>
                        <p>Just click the icon and upload any file you want to store in MEGASD.</p>
                    </div>
                    <div class="col-xs-4 col-xs-offset-4" style="text-align: center">
                        <div class="upload">
                            <i class="fa-file-text"></i>
                        </div>
                    </div>
                </div>
            </div>
            <form class="hidden" method="post" action="/webservice/webresources/webservice.files/upload" enctype="multipart/form-data">
                <input id="upload-input" type="file" name="file" />
                <h:inputText id="userId" value="#{mbAuth.userId}" />
                <input id="upload-submit" type="submit" value="Upload" name="Upload"></input>
            </form>
            <script type="text/javascript">
                var ilock = true;
                $('.upload i').click(function () {
                    if(!ilock) 
                        return;
                    ilock = false;
                    
                    $('#upload-input').click();
                    $('#upload-input').change(function (evnt) {
                        var file = evnt.target.files;
                        console.log(file);
                        $('#upload-submit').click();
                    });
                });
            </script>
        </ui:define>
    </ui:composition>

</html>
